"use strict";(self["webpackChunklaitoutiao"]=self["webpackChunklaitoutiao"]||[]).push([[915],{7978:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-profile"},[t("van-nav-bar",{attrs:{title:"个人资料","left-arrow":""},on:{"click-left":function(t){return e.$router.back()}}}),t("div",{staticClass:"container"},[t("input",{ref:"file",attrs:{type:"file",hidden:"",id:"file",accept:"image/*"},on:{change:e.change}}),t("van-cell",{attrs:{title:"头像",center:""}},[t("label",{attrs:{for:"file"}},[t("van-image",{attrs:{width:"50",height:"50",round:"",fit:"cover",src:e.userInfo.avatar}})],1)]),t("van-cell",{attrs:{title:"昵称","is-link":"",to:{path:"/edit",query:{nickname:e.userInfo.nickname}},value:e.userInfo.nickname}}),t("van-cell",{attrs:{title:"性别","is-link":"",value:e.userInfo.sex||"请选择性别"},on:{click:function(t){e.sexPickerShow=!0}}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.sexPickerShow,callback:function(t){e.sexPickerShow=t},expression:"sexPickerShow"}},[t("van-picker",{attrs:{title:"选择","show-toolbar":"",columns:e.sexColumns},on:{confirm:e.sexPickerConfirm,cancel:function(t){e.sexPickerShow=!1}}})],1),t("van-cell",{attrs:{title:"生日","is-link":"",value:e.userInfo.birthday||"请选择生日"},on:{click:function(t){e.datePickerShow=!0}}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.datePickerShow,callback:function(t){e.datePickerShow=t},expression:"datePickerShow"}},[t("van-datetime-picker",{attrs:{value:e.userInfo.birthday?new Date(e.userInfo.birthday):new Date(2e3,0,1),type:"date",title:"选择年月日","min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.datePickerConfirm,cancel:function(t){e.datePickerShow=!1}}})],1),t("div",{staticStyle:{margin:"30px 50px"}},[t("van-button",{staticStyle:{"background-color":"#7e8ad4"},attrs:{round:"",block:"",size:"normal",square:!0,"native-type":"submit"},on:{click:e.submit}},[e._v("确定")])],1)],1)],1)},a=[],r=n(3822),u=n(2900),o=(n(3891),n(6811)),s=(n(9293),n(7722)),l={data(){return{sexPickerShow:!1,sexColumns:["男","女"]}},components:{[s.Z.name]:s.Z,[o.Z.name]:o.Z},methods:{sexPickerConfirm(e){console.log(e),this.userInfo.sex=e,this.sexPickerShow=!1}}},c=(n(8924),n(7954),n(4577),n(9299)),h=n(855),f=n(8701),m=n(4535),p=n(668);function d(e,t){if(e<0)return[];var n=-1,i=Array(e);while(++n<e)i[n]=t(n);return i}function g(e){if(!e)return 0;while((0,p.i)(parseInt(e,10))){if(!(e.length>1))return 0;e=e.slice(1)}return parseInt(e,10)}function v(e,t){return 32-new Date(e,t-1,32).getDate()}var y=n(7111),k=(0,c.Z)({},y.i,{value:null,filter:Function,columnsOrder:Array,showToolbar:{type:Boolean,default:!0},formatter:{type:Function,default:function(e,t){return t}}}),x={data:function(){return{innerValue:this.formatValue(this.value)}},computed:{originColumns:function(){var e=this;return this.ranges.map((function(t){var n=t.type,i=t.range,a=d(i[1]-i[0]+1,(function(e){var t=(0,f.B)(i[0]+e);return t}));return e.filter&&(a=e.filter(n,a)),{type:n,values:a}}))},columns:function(){var e=this;return this.originColumns.map((function(t){return{values:t.values.map((function(n){return e.formatter(t.type,n)}))}}))}},watch:{columns:"updateColumnValue",innerValue:function(e,t){t?this.$emit("input",e):this.$emit("input",null)}},mounted:function(){var e=this;this.updateColumnValue(),this.$nextTick((function(){e.updateInnerValue()}))},methods:{getPicker:function(){return this.$refs.picker},getProxiedPicker:function(){var e=this,t=this.$refs.picker;if(t){var n=function(n){return function(){t[n].apply(t,arguments),e.updateInnerValue()}};return(0,c.Z)({},t,{setValues:n("setValues"),setIndexes:n("setIndexes"),setColumnIndex:n("setColumnIndex"),setColumnValue:n("setColumnValue")})}},onConfirm:function(){this.$emit("input",this.innerValue),this.$emit("confirm",this.innerValue)},onCancel:function(){this.$emit("cancel")}},render:function(){var e=this,t=arguments[0],n={};return Object.keys(y.i).forEach((function(t){n[t]=e[t]})),t(s.Z,{ref:"picker",attrs:{columns:this.columns,readonly:this.readonly},scopedSlots:this.$scopedSlots,on:{change:this.onChange,confirm:this.onConfirm,cancel:this.onCancel},props:(0,c.Z)({},n)})}},V=(0,h.d)("time-picker"),w=V[0],D=w({mixins:[x],props:(0,c.Z)({},k,{minHour:{type:[Number,String],default:0},maxHour:{type:[Number,String],default:23},minMinute:{type:[Number,String],default:0},maxMinute:{type:[Number,String],default:59}}),computed:{ranges:function(){return[{type:"hour",range:[+this.minHour,+this.maxHour]},{type:"minute",range:[+this.minMinute,+this.maxMinute]}]}},watch:{filter:"updateInnerValue",minHour:function(){var e=this;this.$nextTick((function(){e.updateInnerValue()}))},maxHour:function(e){var t=this.innerValue.split(":"),n=t[0],i=t[1];n>=e?(this.innerValue=this.formatValue(e+":"+i),this.updateColumnValue()):this.updateInnerValue()},minMinute:"updateInnerValue",maxMinute:function(e){var t=this.innerValue.split(":"),n=t[0],i=t[1];i>=e?(this.innerValue=this.formatValue(n+":"+e),this.updateColumnValue()):this.updateInnerValue()},value:function(e){e=this.formatValue(e),e!==this.innerValue&&(this.innerValue=e,this.updateColumnValue())}},methods:{formatValue:function(e){e||(e=(0,f.B)(this.minHour)+":"+(0,f.B)(this.minMinute));var t=e.split(":"),n=t[0],i=t[1];return n=(0,f.B)((0,m.w6)(n,this.minHour,this.maxHour)),i=(0,f.B)((0,m.w6)(i,this.minMinute,this.maxMinute)),n+":"+i},updateInnerValue:function(){var e=this.getPicker().getIndexes(),t=e[0],n=e[1],i=this.originColumns,a=i[0],r=i[1],u=a.values[t]||a.values[0],o=r.values[n]||r.values[0];this.innerValue=this.formatValue(u+":"+o),this.updateColumnValue()},onChange:function(e){var t=this;this.updateInnerValue(),this.$nextTick((function(){t.$nextTick((function(){t.updateInnerValue(),t.$emit("change",e)}))}))},updateColumnValue:function(){var e=this,t=this.formatter,n=this.innerValue.split(":"),i=[t("hour",n[0]),t("minute",n[1])];this.$nextTick((function(){e.getPicker().setValues(i)}))}}});function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function b(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function C(e,t,n){return C=b()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);var a=Function.bind.apply(e,i),r=new a;return n&&I(r,n.prototype),r},C.apply(null,arguments)}function P(e){return"[object Date]"===Object.prototype.toString.call(e)&&!(0,p.i)(e.getTime())}var M=(new Date).getFullYear(),S=(0,h.d)("date-picker"),$=S[0],O=$({mixins:[x],props:(0,c.Z)({},k,{type:{type:String,default:"datetime"},minDate:{type:Date,default:function(){return new Date(M-10,0,1)},validator:P},maxDate:{type:Date,default:function(){return new Date(M+10,11,31)},validator:P}}),watch:{filter:"updateInnerValue",minDate:function(){var e=this;this.$nextTick((function(){e.updateInnerValue()}))},maxDate:function(e){this.innerValue.valueOf()>=e.valueOf()?this.innerValue=e:this.updateInnerValue()},value:function(e){e=this.formatValue(e),e&&e.valueOf()!==this.innerValue.valueOf()&&(this.innerValue=e)}},computed:{ranges:function(){var e=this.getBoundary("max",this.innerValue?this.innerValue:this.minDate),t=e.maxYear,n=e.maxDate,i=e.maxMonth,a=e.maxHour,r=e.maxMinute,u=this.getBoundary("min",this.innerValue?this.innerValue:this.minDate),o=u.minYear,s=u.minDate,l=u.minMonth,c=u.minHour,h=u.minMinute,f=[{type:"year",range:[o,t]},{type:"month",range:[l,i]},{type:"day",range:[s,n]},{type:"hour",range:[c,a]},{type:"minute",range:[h,r]}];switch(this.type){case"date":f=f.slice(0,3);break;case"year-month":f=f.slice(0,2);break;case"month-day":f=f.slice(1,3);break;case"datehour":f=f.slice(0,4);break}if(this.columnsOrder){var m=this.columnsOrder.concat(f.map((function(e){return e.type})));f.sort((function(e,t){return m.indexOf(e.type)-m.indexOf(t.type)}))}return f}},methods:{formatValue:function(e){var t=this;if(!P(e))return null;var n=new Date(this.minDate),i=new Date(this.maxDate),a={year:"getFullYear",month:"getMonth",day:"getDate",hour:"getHours",minute:"getMinutes"};if(this.originColumns){var r=this.originColumns.map((function(e,r){var u=e.type,o=e.values,s=t.ranges[r].range,l=n[a[u]](),c=i[a[u]](),h="month"===u?+o[0]-1:+o[0],f="month"===u?+o[o.length-1]-1:+o[o.length-1];return{type:u,values:[l<s[0]?Math.max(l,h):h||l,c>s[1]?Math.min(c,f):f||c]}}));if("month-day"===this.type){var u=(this.innerValue||this.minDate).getFullYear();r.unshift({type:"year",values:[u,u]})}var o=Object.keys(a).map((function(e){var t;return null==(t=r.filter((function(t){return t.type===e}))[0])?void 0:t.values})).filter((function(e){return e}));n=C(Date,o.map((function(e){return g(e[0])}))),i=C(Date,o.map((function(e){return g(e[1])})))}return e=Math.max(e,n.getTime()),e=Math.min(e,i.getTime()),new Date(e)},getBoundary:function(e,t){var n,i=this[e+"Date"],a=i.getFullYear(),r=1,u=1,o=0,s=0;return"max"===e&&(r=12,u=v(t.getFullYear(),t.getMonth()+1),o=23,s=59),t.getFullYear()===a&&(r=i.getMonth()+1,t.getMonth()+1===r&&(u=i.getDate(),t.getDate()===u&&(o=i.getHours(),t.getHours()===o&&(s=i.getMinutes())))),n={},n[e+"Year"]=a,n[e+"Month"]=r,n[e+"Date"]=u,n[e+"Hour"]=o,n[e+"Minute"]=s,n},updateInnerValue:function(){var e,t,n,i=this,a=this.type,r=this.getPicker().getIndexes(),u=function(e){var t=0;i.originColumns.forEach((function(n,i){e===n.type&&(t=i)}));var n=i.originColumns[t].values;return g(n[r[t]])};"month-day"===a?(e=(this.innerValue||this.minDate).getFullYear(),t=u("month"),n=u("day")):(e=u("year"),t=u("month"),n="year-month"===a?1:u("day"));var o=v(e,t);n=n>o?o:n;var s=0,l=0;"datehour"===a&&(s=u("hour")),"datetime"===a&&(s=u("hour"),l=u("minute"));var c=new Date(e,t-1,n,s,l);this.innerValue=this.formatValue(c)},onChange:function(e){var t=this;this.updateInnerValue(),this.$nextTick((function(){t.$nextTick((function(){t.updateInnerValue(),t.$emit("change",e)}))}))},updateColumnValue:function(){var e=this,t=this.innerValue?this.innerValue:this.minDate,n=this.formatter,i=this.originColumns.map((function(e){switch(e.type){case"year":return n("year",""+t.getFullYear());case"month":return n("month",(0,f.B)(t.getMonth()+1));case"day":return n("day",(0,f.B)(t.getDate()));case"hour":return n("hour",(0,f.B)(t.getHours()));case"minute":return n("minute",(0,f.B)(t.getMinutes()));default:return null}}));this.$nextTick((function(){e.getPicker().setValues(i)}))}}}),H=(0,h.d)("datetime-picker"),Z=H[0],B=H[1],T=Z({props:(0,c.Z)({},D.props,O.props),methods:{getPicker:function(){return this.$refs.root.getProxiedPicker()}},render:function(){var e=arguments[0],t="time"===this.type?D:O;return e(t,{ref:"root",class:B(),scopedSlots:this.$scopedSlots,props:(0,c.Z)({},this.$props),on:(0,c.Z)({},this.$listeners)})}}),F=n(4493),Y={data(){return{datePickerShow:!1,minDate:new Date(1920,0,1),maxDate:new Date}},components:{[T.name]:T,[o.Z.name]:o.Z},methods:{datePickerConfirm(e){console.log(e);let t=(0,F.p)(e);this.userInfo.birthday=t,this.datePickerShow=!1}}},_={name:"userInfo",data(){return{userInfo:{}}},mixins:[l,Y],mounted(){console.log(this.userInfo)},activated(){let e=sessionStorage.getItem("nickname");e&&(this.userInfo.nickname=e)},deactivated(){console.log("加入到缓存")},watch:{"$store.state.userInfo":{immediate:!0,handler(e,t){this.userInfo=JSON.parse(JSON.stringify(e))}}},methods:{...(0,r.nv)(["upload"]),async change(e){console.log();let t=e.target.files[0];this.userInfo.file=t;let n=new FileReader;n.readAsDataURL(t),n.onload=e=>{this.userInfo.avatar=e.target.result}},async submit(){let{_id:e,nickname:t,avatar:n,file:i,sex:a="",birthday:r=""}=this.userInfo;if(i){let e=[{file:i}],t=await this.upload(e);n=t[0]}(0,u.ic)({uid:e,nickname:t,avatar:n,sex:a,birthday:r}).then((e=>{console.log(e),this.$toast(e.msg),0==e.code&&(this.$store.dispatch("getUserInfo",localStorage.getItem("token")),setTimeout((e=>{this.$router.back()}),500))}))}}},j=_,R=n(1001),N=(0,R.Z)(j,i,a,!1,null,"cde33716",null),A=N.exports},4535:function(e,t,n){function i(e,t,n){return Math.min(Math.max(e,t),n)}function a(e,t,n){var i=e.indexOf(t),a="";return-1===i?e:"-"===t&&0!==i?e.slice(0,i):("."===t&&e.match(/^(\.|-\.)/)&&(a=i?"-0":"0"),a+e.slice(0,i+1)+e.slice(i).replace(n,""))}function r(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!0),e=t?a(e,".",/\./g):e.split(".")[0],e=n?a(e,"-",/-/g):e.replace(/-/,"");var i=t?/[^-0-9.]/g:/[^-0-9]/g;return e.replace(i,"")}n.d(t,{uf:function(){return r},w6:function(){return i}})},4493:function(e,t,n){n.d(t,{p:function(){return i}});n(1703);function i(e){try{e instanceof Date||(e=new Date(e));let t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate();return[t,n,i].map((e=>(e+"").length>1?e:"0"+e)).join("/")}catch(t){throw new Error(e+"必须是符合日期格式的字符串,或者时间戳,或者日期对象")}}}}]);
//# sourceMappingURL=915.42f84007.js.map